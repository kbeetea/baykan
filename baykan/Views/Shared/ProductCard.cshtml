@model baykan.Models.Product

<div class="product text-center col-lg-3 col-md-4 col-12">
    <!-- Clickable Image for Product Details -->
    <a href="@Url.Action("Details", "Products", new { id = Model.ProductId })">
        @if (Model.ProductImage != null && Model.ProductImage.Length > 0)
        {
            string base64String = Convert.ToBase64String(Model.ProductImage);
            <img class="img-fluid mb-3" src="data:image/png;base64,@base64String" alt="@Model.ProductName" />
        }
        else
        {
            <img class="img-fluid mb-3" src="~/Content/Images/no-image.png" alt="No Image Available" />
        }
    </a>

    <!-- Star Rating -->
    <div class="star">
        @for (int i = 0; i < 5; i++)
        {
            if (i < Model.AverageRating) // Assuming 'AverageRating' is an integer (0-5)
            {
                <i class="fas fa-star"></i>
            }
            else
            {
                <i class="far fa-star"></i> <!-- Empty Star -->
            }
        }
    </div>

    <!-- Clickable Product Name -->
    <a href="@Url.Action("Details", "Products", new { id = Model.ProductId })" class="text-dark text-decoration-none">
        <h5 class="p-name">@Model.ProductName</h5>
    </a>

    <h4 class="p-price">@Model.ProductPrice.ToString("N0")/-</h4>

    <!-- Buy Now Button -->
    <button class="buy-btn" onclick="handleBuyNow(@Model.ProductId)">Buy Now</button>
</div>

<script>
    function handleBuyNow(productId) {
        var isAuthenticated = '@User.Identity.IsAuthenticated' === 'True';

        if (!isAuthenticated) {
            // Show login modal
            $("#loginModal").modal("show");
        } else {
            // Redirect to cart/checkout page
            window.location.href = "/Cart/AddToCart?productId=" + productId;
        }
    }
</script>


